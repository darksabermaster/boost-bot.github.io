<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level Data Display</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .chunk {
            border: 1px solid #ccc;
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>Level Data Display</h1>
    <div id="data-container"></div>
    
    <script>
        // Function to get URL parameters
        function getUrlParams() {
            const params = {};
            const parser = new URLSearchParams(window.location.search);
            for (const [key, value] of parser.entries()) {
                params[key] = decodeURIComponent(value);
            }
            return params;
        }

        // Initialize an array to store all chunks
        let allChunks = [];
        const params = getUrlParams();

        // Check if there's any data received
        if (params.data) {
            // Add the received data to the allChunks array
            allChunks.push(params.data);
        }

        // Function to display all chunks in the container
        function displayAllChunks() {
            const container = document.getElementById('data-container');
            container.innerHTML = ''; // Clear existing content

            // Display all chunks
            allChunks.forEach((chunk, index) => {
                const chunkDiv = document.createElement('div');
                chunkDiv.className = 'chunk';
                chunkDiv.textContent = `Chunk ${index + 1}: ${chunk}`;
                container.appendChild(chunkDiv);
            });
        }

        // Display the initial chunk
        displayAllChunks();

        // Store chunks in local storage for later retrieval
        if (params.chunk) {
            localStorage.setItem(`chunk_${params.chunk}`, params.data);

            // Retrieve and display all chunks after receiving all parts
            const totalChunks = params.total ? parseInt(params.total) : 1;
            for (let i = 1; i <= totalChunks; i++) {
                const storedChunk = localStorage.getItem(`chunk_${i}`);
                if (storedChunk) {
                    allChunks.push(storedChunk); // Collect all chunks into one array
                }
            }
            displayAllChunks(); // Display all chunks in the single tab
        }
    </script>
</body>
</html>
