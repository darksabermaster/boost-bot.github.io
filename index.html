<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level Data Display</title>
</head>
<body>
    <h1>Level Data</h1>
    <pre id="level-data"></pre>
    
    <script>
        // Function to get URL parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Get the level data from the URL
        const levelData = decodeURIComponent(getQueryParam('data') || '');

        // Process level data to remove duplicate "c_end"
        function processLevelData(data) {
            // Split the data into individual objects
            let levelArray = data.split('},{').map(chunk => {
                chunk = chunk.replace(/^\{/, '').replace(/\}$/, ''); // Clean up the strings
                const obj = {};
                chunk.split(',').forEach(pair => {
                    const [key, value] = pair.split(':');
                    obj[key.trim()] = value.trim();
                });
                return obj;
            });

            // Check if the last object is "c_end"
            if (levelArray.length > 0 && levelArray[levelArray.length - 1].object === '"c_end"') {
                // Only keep the last "c_end" and remove others
                const uniqueLevelArray = [];
                let endObjectAdded = false;

                for (const item of levelArray) {
                    if (item.object === '"c_end"') {
                        if (!endObjectAdded) {
                            uniqueLevelArray.push(item); // Add the first "c_end"
                            endObjectAdded = true; // Flag to ensure only one is added
                        }
                    } else {
                        uniqueLevelArray.push(item); // Add all other objects
                    }
                }
                return uniqueLevelArray;
            }

            return levelArray; // Return the original array if no last "c_end"
        }

        // Process and display the level data
        const processedData = processLevelData(levelData);
        const formattedData = JSON.stringify(processedData, null, 4);
        document.getElementById('level-data').textContent = formattedData;
    </script>
</body>
</html>
